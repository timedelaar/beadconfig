(function(){function n(n){function f(){u();n.getSettings().then(function(n){var u,e,f;t.settings=n.data.settings;t.letters=n.data.letters;t.colors=n.data.colors;t.colors&&t.colors.length>0&&(t.color_line=t.colors[0].slug);for(u in t.settings.beads)for(e in t.settings.beads[u])f=t.settings.beads[u][e],f.imageUrl=r(f.image_location);i()},function(n){console.error("error fetching settings",n);i()})}function e(f){var s,h,o,c,e,l;for(u(),s=0,h=t.colors.length;s<h;s++){o=t.colors[s];for(c in t.settings.beads[o.slug])(e=t.settings.beads[o.slug][c],e.letter&&!e.hasOwnProperty())&&(l=o.slug+"_"+e.letter,f[l].$dirty&&n.uploadImage(e.image,o.slug,e.letter,e.variation_id).then(function(n){var u=n.data,i=t.settings.beads[u.color][u.letter];i&&(i.imageUrl=r(i.image_location))},function(n){console.error("error uploading image",n)},function(){}))}n.saveSettings(t.settings).then(function(){i()},function(n){console.error("error saving settings",n);i()})}function r(n){if(n)return n+"?cb="+(new Date).getTime()}function u(){var n=angular.element('<div class="loader-background"><div class="loader"><\/div>'),t=angular.element("body");t.append(n)}function i(){angular.element(".loader-background").remove()}var t=this;t.settings={general:{},styling:{},beads:{}};t.color_line="";t.save=e;angular.element(document).ready(f)}angular.module("beadConfigSettings",["ngFileUpload"]);angular.module("beadConfigSettings").run(function(n){n.defaults.headers.common["X-WP-Nonce"]=wpApiSettings.nonce});angular.module("beadConfigSettings").controller("beadConfigSettings",["beadConfigSettingsService",n])})(),function(){function n(n,t){function r(){return n({method:"GET",url:"/wp-json/bead-config/v1/plugin-settings/"})}function u(t){return n({method:"PUT",url:"/wp-json/bead-config/v1/plugin-settings/",data:t})}function f(n,i,r,u){if(!n)throw new Error("No image provided for color: "+i+", letter: "+r);return t.upload({url:"/wp-json/bead-config/v1/plugin-settings/image/",data:{image:n,color:i,letter:r,variation_id:u}})}var i=this;i.getSettings=r;i.saveSettings=u;i.uploadImage=f}angular.module("beadConfigSettings").service("beadConfigSettingsService",["$http","Upload",n])}();